<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>08 Electrical Data</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial, sans-serif;
  background: #f2f6ff;
  margin: 0;
}

.header {
  background: #003f88;
  color: white;
  padding: 30px 15px;
  text-align: center;
}
.header h1 { margin: 0; font-size: 36px; }
.header p {
  margin-top: 8px;
  font-size: 18px;
  opacity: 0.95;
}
.header .credit {
  margin-top: 6px;
  font-size: 16px;
  font-weight: 500;
  opacity: 0.95;
}

.container {
  max-width: 1200px;
  margin: 30px auto;
  padding: 0 15px;
  display: grid;
  grid-template-columns: 280px 1fr 280px;
  gap: 20px;
}

.card {
  background: white;
  border-radius: 10px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.15);
  padding: 25px;
}

.card h2 {
  margin-top: 0;
  color: #003f88;
  text-align: center;
}

.master-btns,
.jobs-btns {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

button {
  width: 100%;
  padding: 12px;
  font-size: 15px;
  background: #003f88;
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}
button:hover { opacity: 0.9; }

.select-row {
  display: flex;
  gap: 15px;
  justify-content: center;
  flex-wrap: wrap;
}

select {
  padding: 12px;
  font-size: 16px;
  border-radius: 6px;
  border: 1px solid #ccc;
  min-width: 260px;
}

.button-row {
  margin-top: 20px;
  display: flex;
  gap: 15px;
  justify-content: center;
  flex-wrap: wrap;
}

.footer {
  text-align: center;
  padding: 15px;
  font-size: 14px;
  color: #555;
}

@media (max-width: 1000px) {
  .container { grid-template-columns: 1fr; }
}
@media (max-width: 600px) {
  select, .button-row button { width: 100%; }
}
</style>
</head>

<body>

<div class="header">
  <h1>08 Electrical Data</h1>
  <p>Drive Information & Maintenance History</p>
  <div class="credit">Designed and Maintained by RAKESH CHANDRA SETHY</div>
</div>

<div class="container">

  <!-- MASTER LIST -->
  <div class="card">
    <h2>Master List</h2>
    <div class="master-btns">
      <button onclick="secureOpen('motor')">‚öôÔ∏è Motor List</button>
      <button onclick="secureOpen('trafo')">‚ö° Transformer List</button>
      <button onclick="secureOpen('breaker')">üîå Breaker List</button>
    </div>
  </div>

  <!-- SELECT DRIVE -->
  <div class="card">
    <h2>Select Drive</h2>
    <div class="select-row">
      <select id="mainDrive">
        <option value="">Select Main Drive</option>
      </select>
      <select id="subDrive">
        <option value="">Select Sub Drive</option>
      </select>
    </div>

    <div class="button-row">
      <button onclick="secureView('view')">VIEW</button>
      <button onclick="secureView('history')">HISTORY</button>
    </div>
  </div>

  <!-- JOBS -->
  <div class="card">
    <h2>Jobs</h2>
<div class="jobs-btns">
  <button onclick="secureOpen('date')">üìÖ Datewise Jobs</button>
  <button onclick="secureOpen('advanced')">üìä Advanced Summary</button>
  <button onclick="secureOpen('motoroh')">üõ†Ô∏è Motor O/H Data</button>
  <button onclick="secureOpen('motorpm')">üßæ Motor PM Status</button>
</div>

  </div>

</div>

<div class="footer">
  ¬© 08 Electrical Data | Designed & Maintained by Rakesh Chandra Sethy (08 Electrical)
</div>

<script>
// üî• FAST JSON SOURCE
const JSON_URL =
  "https://raw.githubusercontent.com/08electricaldata/08electricaldata-json/main/dropdown/drives.json";

let headers = [];
let rows = [];
let sheetPassword = "";

// ---------- LOAD JSON ----------
async function loadSheet() {
  const cache = localStorage.getItem("driveJSON");
  if (cache) {
    const d = JSON.parse(cache);
    headers = d.headers;
    rows = d.rows;
    sheetPassword = String(headers[6] || "").trim(); // üîê G1
    buildMain();
    return;
  }

  const r = await fetch(JSON_URL);
  const d = await r.json();

  headers = d.headers;
  rows = d.rows;
  sheetPassword = String(headers[6] || "").trim(); // üîê G1

  localStorage.setItem("driveJSON", JSON.stringify(d));
  buildMain();
}

// ---------- PASSWORD CHECK ----------
function checkPassword() {
  if (!sheetPassword) {
    alert("‚è≥ Data still loading. Please wait.");
    return false;
  }

  const entered = prompt("üîê Enter Password");
  if (entered === null) return false;

  if (String(entered).trim() !== sheetPassword) {
    alert("‚ùå Incorrect password");
    return false;
  }
  return true;
}

// ---------- MAIN DRIVE (FROM H COLUMN) ----------
function buildMain() {
  const main = document.getElementById("mainDrive");
  main.innerHTML = "<option value=''>Select Main Drive</option>";

  headers.forEach((h, i) => {
    if (i < 7 || !h) return;
    const o = document.createElement("option");
    o.value = i;
    o.textContent = h;
    main.appendChild(o);
  });
}

// ---------- SUB DRIVE ----------
document.getElementById("mainDrive").onchange = function () {
  const idx = this.value;
  const sub = document.getElementById("subDrive");
  sub.innerHTML = "<option value=''>Select Sub Drive</option>";
  if (!idx) return;

  rows.forEach(r => {
    const val = r[idx];
    if (val) {
      const o = document.createElement("option");
      o.value = val;
      o.textContent = val;
      sub.appendChild(o);
    }
  });
};

// ---------- SECURE VIEW / HISTORY ----------
function secureView(type) {
  if (!checkPassword()) return;

  const mainSel = document.getElementById("mainDrive");
  const subSel = document.getElementById("subDrive");

  if (!mainSel.value || !subSel.value) {
    alert("Please select Main Drive and Sub Drive");
    return;
  }

  const id = mainSel.selectedOptions[0].text + "-" + subSel.value;
  const base =
    type === "view"
      ? "drive-viewer/index.html?id="
      : "drive-viewer/history.html?id=";

  window.location.href =
    "https://08electricaldata.github.io/" +
    base +
    encodeURIComponent(id);
}

// ---------- SECURE OPEN (ALL OTHER PAGES) ----------
function secureOpen(type) {
  if (!checkPassword()) return;

  const map = {
    motor: "drive-viewer/motorlist.html",
    trafo: "drive-viewer/trafolist.html",
    breaker: "drive-viewer/breakerlist.html",
    date: "drive-viewer/summary-date.html",
    advanced: "drive-viewer/summary-advanced.html",
    motoroh: "drive-viewer/motoroh.html",
    motorpm: "drive-viewer/motorpm.html" // ‚úÖ NEW
  };

  window.location.href =
    "https://08electricaldata.github.io/" + map[type];
}

loadSheet();
</script>

</body>
</html>
